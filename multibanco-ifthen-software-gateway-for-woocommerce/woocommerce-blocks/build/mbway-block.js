(()=>{"use strict";const e=window.wc.wcBlocksRegistry,t=window.wp.i18n,o=window.wc.wcSettings,n=window.wp.htmlEntities,a=window.React,c=window.wp.hooks,l=(0,o.getSetting)("mbway_ifthen_for_woocommerce_data",{}),r=(0,t.__)("MB WAY mobile payment","multibanco-ifthen-software-gateway-for-woocommerce")+" (ifthenpay)",i=(0,n.decodeEntities)(l.title)||r,s=e=>{const[o,r]=(0,a.useState)(l.default_number),[i,s]=(0,a.useState)(l.default_country_code),{eventRegistration:m,emitResponse:_}=e,{onPaymentSetup:p}=m;(0,a.useEffect)((()=>{const e=p((async()=>{const e=o,n=i;return l.allow_international&&"PT"!==n||9===e.length&&"9"===e.charAt(0)?{type:_.responseTypes.SUCCESS,meta:{paymentMethodData:(0,c.applyFilters)("mbway_ifthen_blocks_checkout_payment_data",{mbway_ifthen_for_woocommerce_phone:e,mbway_ifthen_for_woocommerce_country_code:n})}}:{type:_.responseTypes.ERROR,message:(0,t.__)("Invalid MB WAY phone number","multibanco-ifthen-software-gateway-for-woocommerce")}}));return()=>{e()}}),[_.responseTypes.ERROR,_.responseTypes.SUCCESS,p,o,i]);const d=e=>{const t=e.target.value;s(t);const o=document.getElementById(l.id+"_phone");o&&(o.maxLength="PT"===t?9:99)};var u=React.createElement("p",null,(0,n.decodeEntities)(l.description||""));if(l.allow_international){const e=l.country_code_options&&"object"==typeof l.country_code_options?Object.entries(l.country_code_options).map((([e,t])=>({code:e,display:t.display}))):[{code:"PT",value:"+351",display:"Portugal (+351)"}];var y=React.createElement("select",{name:l.id+"_country_code",id:l.id+"_country_code",className:"wc-blocks-components-select__select",options:e,required:!0,value:i,onChange:d},e.map((e=>React.createElement("option",{key:e.code,value:e.code},e.display))));if("PT"===l.default_country_code)var w="9";else w="99"}else y=null,w="9";var h=React.createElement("input",{type:"tel",name:l.id+"_phone",id:l.id+"_phone",placeholder:"9xxxxxxxx",autoComplete:"off",maxLength:w,required:!0,value:o,onChange:e=>{const t=e.target.value.replace(/\D/g,"");r(t)}}),b=React.createElement("label",{htmlFor:l.id+"_phone"},(0,n.decodeEntities)(l.phonenumbertext||"")),f=(0,c.applyFilters)("mbway_ifthen_blocks_checkout_before_phone_number",null);if(l.allow_international){var E=React.createElement("label",{htmlFor:l.id+"_country_code",className:"wc-blocks-components-select__label"},(0,t.__)("Country code","multibanco-ifthen-software-gateway-for-woocommerce")),g=React.createElement("div",{className:"wc-blocks-components-select__container"},"",E,y);g=React.createElement("div",{className:"wc-blocks-components-select"},"",g)}else g=null;var R=React.createElement("div",{className:"wc-block-components-text-input is-active"},"",h,b),v=(0,c.applyFilters)("mbway_ifthen_blocks_checkout_after_phone_number",null);return React.createElement("div",null,u,f,g,R,v)},m={name:"mbway_ifthen_for_woocommerce",label:React.createElement((e=>{var t=React.createElement("img",{src:l.icon,width:l.icon_width,height:l.icon_height,style:{display:"inline"}});return React.createElement("span",{className:"wc-block-components-payment-method-label wc-block-components-payment-method-label--with-icon"},t,(0,n.decodeEntities)(l.title)||r)}),null),content:React.createElement(s,null),edit:React.createElement(s,null),icons:null,canMakePayment:e=>{if("EUR"!=e.cartTotals.currency_code)return!1;if(l.only_portugal&&"PT"!=e.billingData.country&&"PT"!=e.shippingAddress.country)return!1;var t=e.cartTotals.total_price/100;return!(l.only_above&&t<l.only_above||l.only_bellow&&t>l.only_bellow)},ariaLabel:i,supports:{features:l.supports}};(0,e.registerPaymentMethod)(m)})();